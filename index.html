<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!-- Google AdSense Verification Code: MUST be placed here for approval -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3959241918183585"
     crossorigin="anonymous"></script>
    <!-- End AdSense Verification -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="page-title">Universal Engineering Unit Converter</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #f4f7f9; }
        .conversion-card { transition: all 0.3s ease; }
        .conversion-card:hover { transform: translateY(-2px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); }
        .unit-select { appearance: none; background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="%234A5568"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/></svg>'); background-repeat: no-repeat; background-position: right 0.7rem center; background-size: 0.8rem 0.8rem; }
        /* Style for RTL text alignment (Urdu) */
        [dir="rtl"] .rtl-align { text-align: right; }
    </style>
</head>
<body>

<div class="max-w-7xl mx-auto p-4 sm:p-6 lg:p-8">

    <!-- Header and Language Selector -->
    <div class="flex justify-between items-center mb-6">
        <h1 class="text-3xl font-extrabold text-gray-800" id="main-header">Universal Unit Converter</h1>
        <div class="flex items-center space-x-2">
            <i class="fas fa-globe text-gray-500"></i>
            <select id="language-select" onchange="changeLanguage(this.value)" class="p-2 border border-gray-300 rounded-lg text-sm bg-white unit-select">
                <option value="en">English</option>
                <option value="ur">اردو (Urdu)</option>
                <option value="ru">Русский (Russian)</option>
            </select>
        </div>
    </div>
    
    <!-- Ad Slot 1: Top Leaderboard -->
    <div class="w-full h-24 bg-gray-200 flex items-center justify-center rounded-xl mb-8">
        [ AD SLOT 1: TOP LEADERBOARD Placeholder (e.g., 728x90) ]
    </div>

    <!-- Unit Category Breakdown Table -->
    <div class="bg-white p-6 rounded-xl shadow-lg mb-8" id="category-table-container">
        <h2 class="text-xl font-semibold text-gray-700 mb-4" id="table-header">Conversion Categories Explained</h2>
        <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-gray-200">
                <thead class="bg-gray-50">
                    <tr>
                        <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider" id="col-category">Category</th>
                        <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider" id="col-types">Primary Conversion Types</th>
                        <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider" id="col-relevance">Relevance & Notes</th>
                    </tr>
                </thead>
                <tbody class="bg-white divide-y divide-gray-200 text-sm">
                    <!-- Table rows populated dynamically or hardcoded -->
                </tbody>
            </table>
        </div>
    </div>
    
    <!-- Ad Slot 2: Medium Rectangle / Native Slot -->
    <div class="w-full h-32 bg-gray-200 flex items-center justify-center rounded-xl my-8">
        [ AD SLOT 2: MEDIUM RECTANGLE / NATIVE Placeholder (e.g., 300x250) ]
    </div>

    <!-- Conversion Tool Section -->
    <div class="bg-white p-8 rounded-xl shadow-xl border border-gray-100">
        <h2 class="text-2xl font-bold text-gray-800 mb-6" id="tool-header">Engineering Unit Conversion Tool</h2>
        
        <!-- Category Selector -->
        <div class="mb-6">
            <label for="category" class="block text-sm font-medium text-gray-700 mb-2" id="label-category">Select Category:</label>
            <select id="category-select" onchange="updateUnits()" class="w-full p-3 border border-gray-300 rounded-lg bg-gray-50 text-gray-800 focus:ring-blue-500 focus:border-blue-500 unit-select">
                <!-- Options populated by JS -->
            </select>
        </div>
        
        <!-- Conversion Input/Output Grid -->
        <div class="grid grid-cols-1 md:grid-cols-5 gap-6 items-center">
            
            <!-- Input Card -->
            <div class="col-span-1 md:col-span-2 conversion-card bg-blue-50 p-5 rounded-xl border border-blue-200">
                <label for="input-value" class="block text-xs font-medium text-blue-700 uppercase mb-2" id="label-input-value">Input Value (From)</label>
                <input type="number" id="input-value" value="1" oninput="performConversion()" class="w-full text-2xl font-bold p-2 mb-3 rounded-lg border-0 focus:ring-blue-500 focus:border-blue-500 shadow-sm">
                
                <label for="source-unit" class="block text-xs font-medium text-blue-700 uppercase mb-2" id="label-source-unit">Source Unit</label>
                <select id="source-unit" onchange="performConversion()" class="unit-select w-full p-3 border border-blue-300 rounded-lg bg-white text-gray-800 focus:ring-blue-500 focus:border-blue-500 shadow-sm">
                    <!-- Options populated by JS -->
                </select>
            </div>
            
            <!-- Swap Button -->
            <div class="col-span-1 flex justify-center">
                <button onclick="swapUnits()" class="p-3 bg-gray-200 hover:bg-gray-300 rounded-full transition duration-150 ease-in-out shadow-md text-gray-700 w-12 h-12 flex items-center justify-center">
                    <i class="fas fa-exchange-alt"></i>
                </button>
            </div>

            <!-- Output Card -->
            <div class="col-span-1 md:col-span-2 conversion-card bg-green-50 p-5 rounded-xl border border-green-200">
                <label for="output-value" class="block text-xs font-medium text-green-700 uppercase mb-2" id="label-output-value">Converted Value (To)</label>
                <div class="w-full text-2xl font-bold p-2 mb-3 bg-white rounded-lg border border-green-300 shadow-sm">
                    <span id="output-result" class="text-gray-900">0</span>
                    <span id="output-unit-symbol" class="text-gray-600 ml-2"></span>
                </div>
                
                <label for="target-unit" class="block text-xs font-medium text-green-700 uppercase mb-2" id="label-target-unit">Target Unit</label>
                <select id="target-unit" onchange="performConversion()" class="unit-select w-full p-3 border border-green-300 rounded-lg bg-white text-gray-800 focus:ring-green-500 focus:border-green-500 shadow-sm">
                    <!-- Options populated by JS -->
                </select>
            </div>
        </div>

        <p id="conversion-formula" class="mt-6 p-4 bg-gray-50 text-gray-600 rounded-lg text-sm italic border-l-4 border-gray-300"></p>
        <p id="error-message" class="mt-4 p-3 bg-red-100 text-red-700 rounded-lg text-sm font-medium hidden"></p>
    </div>

    <!-- Ad Slot 3: Bottom Banner -->
    <div class="w-full h-24 bg-gray-200 flex items-center justify-center rounded-xl mt-8">
        [ AD SLOT 3: BOTTOM BANNER Placeholder (e.g., 970x90 or 728x90) ]
    </div>

    <!-- Compliance Footer -->
    <footer class="mt-12 border-t border-gray-200 pt-6 text-center text-sm text-gray-500">
        &copy; <span id="current-year"></span> Universal Unit Converter. All rights reserved. |
        <a href="privacy.html" class="hover:text-gray-700 transition duration-150">Privacy Policy</a> |
        <a href="terms.html" class="hover:text-gray-700 transition duration-150">Terms of Use</a>
    </footer>

</div>

<script>
    // --- UNIT DEFINITIONS ---
    const BASE_DECIMALS = 6; // Number of decimals for standard conversion display

    const UNITS = {
        length: {
            base: 'Meter (m)',
            factor: {
                'Millimeter (mm)': 0.001,
                'Centimeter (cm)': 0.01,
                'Meter (m)': 1,
                'Kilometer (km)': 1000,
                'Inch (in)': 0.0254,
                'Foot (ft)': 0.3048,
                'Yard (yd)': 0.9144,
                'Mile (mi)': 1609.34,
                'Nautical mile (NM)': 1853,
                'Sooter': 0.003175, // 1/8th of an inch * 0.0254 = 0.003175
            }
        },
        mass: {
            base: 'Kilogram (kg)',
            factor: {
                'Gram (g)': 0.001,
                'Kilogram (kg)': 1,
                'Tonne (M Ton)': 1000,
                'Pound (lb)': 0.453592,
                'Cwt (kg)': 50.80,
                'Ton (British) (T)': 1016.05,
            }
        },
        temperature: {
            base: 'Kelvin (K)',
            factor: {
                // Temperature is non-linear, handled by special function
            }
        },
        pressure: {
            base: 'Pascal (Pa)',
            factor: {
                'Pascal (Pa)': 1,
                'KiloPascal (kPa)': 1000,
                'MegaPascal (MPa)': 1000000,
                'Bar (bar)': 100000,
                'Atmosphere (atm)': 101325,
                'PSI (lb/in²)': 6894.76,
                'PSF (lb/ft²)': 47.8803,
                'kg/cm²': 98066.5,
            }
        },
        energy: {
            base: 'Joule (J)',
            factor: {
                'Joule (J)': 1,
                'Kilojoule (kJ)': 1000,
                'Watt-hour (Wh)': 3600,
                'Kilowatt-hour (kWh)': 3600000,
                'BTU': 1055.06,
                'ft-lb': 1.35582,
                'Ton TNT (J)': 4.184e9,
            }
        },
        force: {
            base: 'Newton (N)',
            factor: {
                'Newton (N)': 1,
                'KiloNewton (kN)': 1000,
                'Pound-force (lbf)': 4.44822,
                'Kilogram-force (kgf)': 9.80665,
                'Kip (k)': 4448.22,
                'Ton-force (tf)': 9806.65,
            }
        },
        power: {
            base: 'Watt (W)',
            factor: {
                'Watt (W)': 1,
                'Kilowatt (kW)': 1000,
                'Metric Horsepower (hp)': 735.499,
                'Brake Horsepower (BHP)': 745.7,
                'ft-lb/min': 0.022597,
                'Tons (A/C)': 3516.85, // 1 Ton of refrigeration
                'BTU/hr': 0.293071,
            }
        },
        area: {
            base: 'Square Meter (m²)',
            factor: {
                'Square Millimeter (mm²)': 0.000001,
                'Square Centimeter (cm²)': 0.0001,
                'Square Meter (m² / sqm)': 1,
                'Square Kilometer (km²)': 1000000,
                'Square Inch (in² / sq in)': 0.00064516,
                'Square Foot (ft² / sq ft)': 0.092903,
                'Square Yard (yd² / sq yd)': 0.836127,
                'Acre': 4046.86,
                'Hectare (ha)': 10000,
                'Square Mile (mi²)': 2589988,
            }
        },
        volume: {
            base: 'Cubic Meter (m³)',
            factor: {
                'Cubic Millimeter (mm³)': 1e-9,
                'Cubic Centimeter (cm³ / cc)': 1e-6,
                'Cubic Meter (m³ / cum)': 1,
                'Cubic Inch (in³ / cu in)': 1.63871e-5,
                'Cubic Foot (ft³ / cu ft)': 0.0283168,
                'Cubic Yard (yd³ / cu yd)': 0.764555,
                'US Gallon (US gal)': 0.00378541,
                'British Gallon (UK gal)': 0.00454609,
                'Litre (L / lit)': 0.001,
            }
        },
        density: {
            base: 'Kilogram per Cubic Meter (kg/m³)',
            factor: {
                'kg/m³': 1,
                'g/cm³': 1000,
                'lb/ft³': 16.0185,
                'kN/m³': 101.972, // Using 9.807 m/s² for g, so 1kN/m³ ≈ 101.972 kg/m³
                'M Ton/m³': 1000, // Metric Tonne is 1000 kg
            }
        },
        flowrate: {
            base: 'Cubic Meter per Second (m³/s)',
            factor: {
                'm³/s': 1,
                'ft³/s (cusec)': 0.0283168,
                'L/s': 0.001,
                'US GPM': 6.30902e-5, // US Gallons per minute
                'MGD': 0.0438126, // Million Gallons per day
            }
        },
        torque: {
            base: 'Newton Meter (N·m)',
            factor: {
                'Newton Meter (N·m)': 1,
                'kilonewton meter (kN·m)': 1000,
                'Foot-Pound (ft-lb)': 1.35582,
                'Inch-Pound (in-lb)': 0.112985,
                'Kilogram-force meter (kgf·m)': 9.80665,
            }
        },
        time: {
            base: 'Second (s)',
            factor: {
                'Millisecond (ms)': 0.001,
                'Second (s)': 1,
                'Minute (min)': 60,
                'Hour (hr)': 3600,
                'Day (day)': 86400,
                'Week (wk)': 604800,
                'Year (yr)': 31536000,
            }
        },
        velocity: {
            base: 'Meter per Second (m/s)',
            factor: {
                'Meter per Second (m/s)': 1,
                'Kilometer per Hour (km/h)': 0.277778,
                'Mile per Hour (mph)': 0.44704,
                'Foot per Second (ft/s)': 0.3048,
                'Knot (kn)': 0.514444,
                'Mach (M)': 343, // Mach 1 at standard conditions
            }
        }
    };

    // --- TRANSLATION DATA ---
    const TRANSLATIONS = {
        en: {
            'page-title': 'Universal Engineering Unit Converter',
            'main-header': 'Universal Unit Converter',
            'table-header': 'Conversion Categories Explained',
            'col-category': 'Category',
            'col-types': 'Primary Conversion Types',
            'col-relevance': 'Relevance & Notes',
            'tool-header': 'Engineering Unit Conversion Tool',
            'label-category': 'Select Category:',
            'label-input-value': 'Input Value (From)',
            'label-source-unit': 'Source Unit',
            'label-output-value': 'Converted Value (To)',
            'label-target-unit': 'Target Unit',
            'error-generic': 'Error: Invalid input or conversion factor missing.',
            'formula-standard': 'Formula: Base Value = Input × Source Factor; Result = Base Value / Target Factor',
            'formula-temp': 'Formula: Uses Kelvin as the intermediate base unit for accurate non-linear conversion.',
            
            // Table Row Content (Index corresponds to table row generation order)
            'row-length-type': 'Distance, dimensions, and heights.',
            'row-length-rel': 'Includes common units (meter, foot, inch) and the specialized sooter (1/8th of an inch).',
            'row-area-type': 'Surface area and land measurement.',
            'row-area-rel': 'Converts standard square units (ft², m²) as well as acre and hectare for land/site work.',
            'row-volume-type': 'Material quantities and liquid capacity.',
            'row-volume-rel': 'Essential for concrete, brickwork, and excavation (m³, ft³, yd³), along with liquid units.',
            'row-mass-type': 'Weight of objects or materials.',
            'row-mass-rel': 'Standard mass units (kg, lb) plus British Ton and Hundredweight (Cwt).',
            'row-density-type': 'Mass or weight per unit volume.',
            'row-density-rel': 'Critical for civil engineering material calculations (kN/m³, lb/ft³).',
            'row-force-type': 'Applied loads and gravitational force.',
            'row-force-rel': 'Converts standard force (Newton, KiloNewton) and high loads (Kip).',
            'row-pressure-type': 'Force exerted per unit area.',
            'row-pressure-rel': 'Essential for fluid mechanics and structural loads (MPa, psi, kPa, atm).',
            'row-energy-type': 'Work and rate of energy transfer.',
            'row-energy-rel': 'Includes standard physics (Joule, Watt) and thermal units (BTU, Watt-hour, HP).',
            'row-flowrate-type': 'Volumetric flow rate.',
            'row-flowrate-rel': 'Measures volume per time (cusec, GPM).',
            'row-torque-type': 'Rotational force measurement.',
            'row-torque-rel': 'Commonly used in mechanical and automotive engineering (N·m, ft-lb).',
            'row-temperature-type': 'Measures of heat and cold.',
            'row-temperature-rel': 'Non-linear conversions between Kelvin, Celsius, and Fahrenheit.',
            'row-time-type': 'Duration and intervals.',
            'row-time-rel': 'Includes milliseconds, seconds, minutes, hours, days, weeks, and years.',
            'row-velocity-type': 'Speed and rate of displacement.',
            'row-velocity-rel': 'Critical for dynamics, transport, and fluid flow (m/s, km/h, mph, knot).',
        },
        ur: {
            'page-title': 'یونیورسل انجینئرنگ یونٹ کنورٹر',
            'main-header': 'یونیورسل یونٹ کنورٹر',
            'table-header': 'تبدیلی کے زمرے کی وضاحت',
            'col-category': 'زمرہ',
            'col-types': 'بنیادی تبدیلی کی اقسام',
            'col-relevance': 'اہمیت اور نوٹس',
            'tool-header': 'انجینئرنگ یونٹ تبدیلی کا آلہ',
            'label-category': 'زمرہ منتخب کریں:',
            'label-input-value': 'ان پٹ ویلیو (سے)',
            'label-source-unit': 'ماخذ یونٹ',
            'label-output-value': 'تبدیل شدہ ویلیو (تک)',
            'label-target-unit': 'ہدف یونٹ',
            'error-generic': 'خرابی: غلط ان پٹ یا تبدیلی کا عنصر غائب ہے۔',
            'formula-standard': 'فارمولا: بنیادی ویلیو = ان پٹ × ماخذ فیکٹر؛ نتیجہ = بنیادی ویلیو / ہدف فیکٹر',
            'formula-temp': 'فارمولا: درست نان لینیئر تبدیلی کے لیے کیلون کو انٹرمیڈیٹ بنیادی یونٹ کے طور پر استعمال کرتا ہے۔',
            
            // Table Row Content (Index corresponds to table row generation order)
            'row-length-type': 'فاصلہ، طول و عرض، اور اونچائیاں۔',
            'row-length-rel': 'عام یونٹس (میٹر، فٹ، انچ) اور خصوصی سوٹر (انچ کا 1/8واں حصہ) شامل ہے۔',
            'row-area-type': 'سطحی رقبہ اور زمین کی پیمائش۔',
            'row-area-rel': 'معیاری مربع یونٹس (ft²، m²) کے ساتھ ساتھ زمین/سائٹ کے کام کے لیے ایکڑ اور ہیکٹر کو تبدیل کرتا ہے۔',
            'row-volume-type': 'مواد کی مقدار اور مائع کی گنجائش۔',
            'row-volume-rel': 'کنکریٹ، اینٹوں کے کام، اور کھدائی (m³، ft³، yd³) کے ساتھ ساتھ مائع یونٹس کے لیے ضروری ہے۔',
            'row-mass-type': 'اشیاء یا مواد کا وزن۔',
            'row-mass-rel': 'معیاری ماس یونٹس (kg، lb) کے علاوہ برطانوی ٹن اور سینکڑوں وزن (Cwt)۔',
            'row-density-type': 'ماس یا وزن فی یونٹ حجم۔',
            'row-density-rel': 'سول انجینئرنگ مواد کے حساب کتاب کے لیے اہم (kN/m³، lb/ft³).',
            'row-force-type': 'لاگو بوجھ اور کشش ثقل کی قوت۔',
            'row-force-rel': 'معیاری قوت (نیوٹن، کلو نیوٹن) اور زیادہ بوجھ (Kip) کو تبدیل کرتا ہے۔',
            'row-pressure-type': 'فی یونٹ رقبہ پر لگنے والی قوت۔',
            'row-pressure-rel': 'سیال میکانکس اور ساختی بوجھ کے لیے ضروری (MPa، psi، kPa، atm).',
            'row-energy-type': 'کام اور توانائی کی منتقلی کی شرح۔',
            'row-energy-rel': 'معیاری طبیعیات (جول، واٹ) اور تھرمل یونٹس (BTU، واٹ آور، HP) شامل ہیں۔',
            'row-flowrate-type': 'حجمی بہاؤ کی شرح۔',
            'row-flowrate-rel': 'حجم فی وقت کی پیمائش کرتا ہے (cusec، GPM).',
            'row-torque-type': 'گردشی قوت کی پیمائش۔',
            'row-torque-rel': 'عام طور پر مکینیکل اور آٹوموٹو انجینئرنگ میں استعمال ہوتا ہے (N·m، ft-lb).',
            'row-temperature-type': 'گرمی اور سردی کی پیمائش۔',
            'row-temperature-rel': 'کیلون، سیلسیس، اور فارن ہائیٹ کے درمیان نان لینیئر تبدیلیاں۔',
            'row-time-type': 'دورانیہ اور وقفے۔',
            'row-time-rel': 'ملی سیکنڈ، سیکنڈ، منٹ، گھنٹے، دن، ہفتے، اور سال شامل ہیں۔',
            'row-velocity-type': 'رفتار اور نقل مکانی کی شرح۔',
            'row-velocity-rel': 'متحرک، نقل و حمل، اور سیال بہاؤ کے لیے اہم (m/s، km/h، mph، knot).',
        },
        ru: {
            'page-title': 'Универсальный инженерный конвертер единиц',
            'main-header': 'Универсальный конвертер единиц',
            'table-header': 'Объяснение категорий конвертации',
            'col-category': 'Категория',
            'col-types': 'Основные типы конвертации',
            'col-relevance': 'Актуальность и примечания',
            'tool-header': 'Инструмент конвертации инженерных единиц',
            'label-category': 'Выбрать категорию:',
            'label-input-value': 'Входное значение (Из)',
            'label-source-unit': 'Исходная единица',
            'label-output-value': 'Конвертированное значение (В)',
            'label-target-unit': 'Целевая единица',
            'error-generic': 'Ошибка: Неверный ввод или отсутствует коэффициент конвертации.',
            'formula-standard': 'Формула: Базовое значение = Ввод × Исходный коэффициент; Результат = Базовое значение / Целевой коэффициент',
            'formula-temp': 'Формула: Использует Кельвин в качестве промежуточной базовой единицы для точной нелинейной конвертации.',
            
            // Table Row Content (Index corresponds to table row generation order)
            'row-length-type': 'Расстояние, размеры и высота.',
            'row-length-rel': 'Включает общие единицы (метр, фут, дюйм) и специализированный сутер (1/8 дюйма).',
            'row-area-type': 'Площадь поверхности и измерение земли.',
            'row-area-rel': 'Конвертирует стандартные квадратные единицы (фт², м²), а также акр и гектар для земельных/строительных работ.',
            'row-volume-type': 'Количество материалов и вместимость жидкости.',
            'row-volume-rel': 'Необходимо для бетона, кирпичной кладки и земляных работ (м³, фт³, ярд³), а также для единиц жидкости.',
            'row-mass-type': 'Вес объектов или материалов.',
            'row-mass-rel': 'Стандартные единицы массы (кг, фунт) плюс британская тонна и центнер (Cwt).',
            'row-density-type': 'Масса или вес на единицу объема.',
            'row-density-rel': 'Критично для расчетов материалов в гражданском строительстве (кН/м³, фунт/фут³).',
            'row-force-type': 'Приложенные нагрузки и сила тяжести.',
            'row-force-rel': 'Конвертирует стандартные силы (Ньютон, Килоньютон) и большие нагрузки (Кип).',
            'row-pressure-type': 'Сила, приложенная на единицу площади.',
            'row-pressure-rel': 'Необходимо для гидромеханики и структурных нагрузок (МПа, фунт/дюйм², кПа, атм).',
            'row-energy-type': 'Работа и скорость передачи энергии.',
            'row-energy-rel': 'Включает стандартную физику (Джоуль, Ватт) и тепловые единицы (БТЕ, Ватт-час, л.с.).',
            'row-flowrate-type': 'Объемный расход.',
            'row-flowrate-rel': 'Измеряет объем в единицу времени (кусек, галлонов/мин).',
            'row-torque-type': 'Измерение вращательной силы.',
            'row-torque-rel': 'Обычно используется в механике и автомобилестроении (Н·м, фут-фунт).',
            'row-temperature-type': 'Измерение тепла и холода.',
            'row-temperature-rel': 'Нелинейные конвертации между Кельвином, Цельсием и Фаренгейтом.',
            'row-time-type': 'Продолжительность и интервалы.',
            'row-time-rel': 'Включает миллисекунды, секунды, минуты, часы, дни, недели и годы.',
            'row-velocity-type': 'Скорость и темп перемещения.',
            'row-velocity-rel': 'Критично для динамики, транспорта и потока жидкости (м/с, км/ч, миль/ч, узел).',
        }
    };

    // --- MAIN LOGIC ---

    document.addEventListener('DOMContentLoaded', () => {
        populateCategorySelect();
        updateUnits(); // Initialize units for the default category
        document.getElementById('current-year').textContent = new Date().getFullYear();
        changeLanguage('en'); // Set default language
    });

    // Helper to get element text content for current language
    const getTranslation = (key) => {
        const lang = document.getElementById('language-select').value;
        return TRANSLATIONS[lang][key] || TRANSLATIONS['en'][key] || key;
    };

    // Fills the main category dropdown
    function populateCategorySelect() {
        const select = document.getElementById('category-select');
        select.innerHTML = '';
        Object.keys(UNITS).forEach(categoryKey => {
            const option = document.createElement('option');
            // Capitalize the first letter for display
            option.value = categoryKey;
            option.textContent = categoryKey.charAt(0).toUpperCase() + categoryKey.slice(1);
            select.appendChild(option);
        });
    }

    // Updates source and target unit dropdowns based on selected category
    function updateUnits() {
        const categoryKey = document.getElementById('category-select').value;
        const unitData = UNITS[categoryKey];
        const units = unitData.factor ? Object.keys(unitData.factor) : [unitData.base];

        const sourceSelect = document.getElementById('source-unit');
        const targetSelect = document.getElementById('target-unit');

        [sourceSelect, targetSelect].forEach(select => {
            select.innerHTML = '';
            units.forEach(unit => {
                const option = document.createElement('option');
                option.value = unit;
                option.textContent = unit;
                select.appendChild(option);
            });
        });

        // Set default units
        if (units.length > 1) {
            sourceSelect.value = units[0];
            targetSelect.value = units[1];
        }

        // Populate the category explanation table
        populateCategoryTable();
        // Recalculate conversion after unit change
        performConversion();
    }

    // Populates the dynamic category explanation table
    function populateCategoryTable() {
        const tbody = document.querySelector('#category-table-container tbody');
        tbody.innerHTML = '';
        Object.entries(UNITS).forEach(([key, data]) => {
            const row = tbody.insertRow();
            row.className = 'hover:bg-gray-50';

            const categoryCell = row.insertCell();
            categoryCell.className = 'px-3 py-2 whitespace-nowrap font-medium text-gray-900';
            categoryCell.textContent = key.charAt(0).toUpperCase() + key.slice(1);

            const typesCell = row.insertCell();
            typesCell.className = 'px-3 py-2';
            typesCell.textContent = getTranslation(`row-${key}-type`);

            const relevanceCell = row.insertCell();
            relevanceCell.className = 'px-3 py-2';
            relevanceCell.textContent = getTranslation(`row-${key}-rel`);
        });
    }

    // Handles the core calculation logic
    function performConversion() {
        const categoryKey = document.getElementById('category-select').value;
        const inputValue = parseFloat(document.getElementById('input-value').value);
        const sourceUnit = document.getElementById('source-unit').value;
        const targetUnit = document.getElementById('target-unit').value;
        const outputResult = document.getElementById('output-result');
        const outputSymbol = document.getElementById('output-unit-symbol');
        const errorMessage = document.getElementById('error-message');
        const formulaDisplay = document.getElementById('conversion-formula');

        errorMessage.classList.add('hidden');
        formulaDisplay.classList.remove('hidden');

        if (isNaN(inputValue)) {
            outputResult.textContent = '0';
            errorMessage.textContent = getTranslation('error-generic');
            errorMessage.classList.remove('hidden');
            return;
        }

        let result;

        if (categoryKey === 'temperature') {
            result = convertTemperature(inputValue, sourceUnit, targetUnit);
            formulaDisplay.textContent = getTranslation('formula-temp');
        } else {
            result = convertStandard(inputValue, sourceUnit, targetUnit, categoryKey);
            formulaDisplay.textContent = getTranslation('formula-standard');
        }

        if (isNaN(result) || result === null) {
            outputResult.textContent = 'Error';
            errorMessage.textContent = getTranslation('error-generic');
            errorMessage.classList.remove('hidden');
            outputSymbol.textContent = '';
        } else {
            // Round to a large number of decimals and strip trailing zeros
            const roundedResult = parseFloat(result.toFixed(BASE_DECIMALS));
            outputResult.textContent = roundedResult.toLocaleString('en-US', { maximumFractionDigits: BASE_DECIMALS });
            outputSymbol.textContent = targetUnit.substring(targetUnit.indexOf('(') + 1, targetUnit.indexOf(')'));
        }
    }

    // Standard linear conversion (Length, Mass, Area, etc.)
    function convertStandard(value, fromUnit, toUnit, category) {
        const factors = UNITS[category].factor;
        const fromFactor = factors[fromUnit];
        const toFactor = factors[toUnit];

        if (!fromFactor || !toFactor) return NaN;

        // 1. Convert source value to the base unit
        const baseValue = value * fromFactor;
        // 2. Convert base value to the target unit
        const result = baseValue / toFactor;

        return result;
    }

    // Temperature non-linear conversion
    function convertTemperature(value, fromUnit, toUnit) {
        // Step 1: Convert all inputs to the base unit (Kelvin)
        let kelvin;

        switch (fromUnit) {
            case 'Celsius (°C)':
                kelvin = value + 273.15;
                break;
            case 'Fahrenheit (°F)':
                kelvin = (value - 32) * 5 / 9 + 273.15;
                break;
            case 'Kelvin (K)':
                kelvin = value;
                break;
            default:
                return NaN;
        }

        // Step 2: Convert Kelvin to the target unit
        switch (toUnit) {
            case 'Celsius (°C)':
                return kelvin - 273.15;
            case 'Fahrenheit (°F)':
                return (kelvin - 273.15) * 9 / 5 + 32;
            case 'Kelvin (K)':
                return kelvin;
            default:
                return NaN;
        }
    }

    // Swaps the source and target units
    function swapUnits() {
        const sourceSelect = document.getElementById('source-unit');
        const targetSelect = document.getElementById('target-unit');

        const tempValue = sourceSelect.value;
        sourceSelect.value = targetSelect.value;
        targetSelect.value = tempValue;

        performConversion();
    }

    // --- LOCALIZATION ---

    function changeLanguage(lang) {
        const textElements = [
            'page-title', 'main-header', 'table-header', 'col-category', 'col-types', 'col-relevance',
            'tool-header', 'label-category', 'label-input-value', 'label-source-unit',
            'label-output-value', 'label-target-unit'
        ];

        // 1. Update static text elements
        textElements.forEach(id => {
            const element = document.getElementById(id);
            if (element) {
                element.textContent = getTranslation(id);
            }
        });

        // 2. Update dynamic content
        const formulaText = (document.getElementById('category-select').value === 'temperature') ? 'formula-temp' : 'formula-standard';
        document.getElementById('conversion-formula').textContent = getTranslation(formulaText);
        
        // 3. Update Category Table
        populateCategoryTable();

        // 4. Handle RTL alignment for Urdu
        const body = document.body;
        if (lang === 'ur') {
            body.setAttribute('dir', 'rtl');
            body.classList.add('rtl-align');
        } else {
            body.setAttribute('dir', 'ltr');
            body.classList.remove('rtl-align');
        }
    }
</script>

</body>
</html>
